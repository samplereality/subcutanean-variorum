<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Subcutanean Variorum - Compare Textual Variations</title>
    <meta name="description" content="Compare textual variations across unique editions of Aaron Reed's novel Subcutanean. Features four view modes, word differential analysis, and support for custom uploads.">
    <link rel="canonical" href="https://subcutanean.fugitivetexts.net/">

    <!-- Open Graph / Social Media -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://subcutanean.fugitivetexts.net/">
    <meta property="og:title" content="Subcutanean Variorum">
    <meta property="og:description" content="Compare textual variations across unique editions of Aaron Reed's novel Subcutanean.">

    <!-- Stylesheets -->
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="compare.css">
</head>
<body>
    <header>
        <button id="about-btn" class="hamburger-btn" title="About this project">
            <span class="hamburger-line"></span>
            <span class="hamburger-line"></span>
            <span class="hamburger-line"></span>
        </button>
        <h1>Subcutanean Variorum</h1>
        <p class="subtitle">Compare multiple versions of Aaron Reed’s variable novel, <em>Subcutanean</em> (2020)</p>

        <div class="comparison-controls">
            <div class="version-selectors">
                <div class="selector-group">
                    <label for="version-a-select">Compare</label>
                    <select id="version-a-select" class="version-select">
                        <!-- Options populated by JavaScript -->
                    </select>
                </div>

                <div class="selector-group">
                    <label for="version-b-select">With</label>
                    <select id="version-b-select" class="version-select">
                        <!-- Options populated by JavaScript -->
                    </select>
                </div>
            </div>

            <div class="view-mode-selector">
                <label>View mode:</label>
                <div class="button-group">
                    <button id="mode-unified" class="mode-btn" title="Read a single version without comparison">Unified</button>
                    <button id="mode-sidebyside" class="mode-btn active" title="View two versions in parallel columns">Side-by-side</button>
                    <button id="mode-diff" class="mode-btn" title="Highlight additions and deletions between versions">Track Changes</button>
                    <button id="mode-comparison" class="mode-btn" title="Compare variations across multiple witnesses">Collation</button>
                </div>
            </div>

            <div class="upload-section">
                <label for="epub-upload" class="upload-btn tool-btn" title="Upload your own copy of Subcutanean">
                    <span id="upload-text">Upload EPUB/TXT</span>
                    <input type="file" id="epub-upload" accept=".epub,.txt" style="display: none;">
                </label>
                <button id="manage-uploads-btn" class="tool-btn" title="Manage uploaded versions">Manage Uploads</button>
                <span id="upload-status" class="upload-status"></span>
            </div>

            <div class="tools-row">
                <div class="search-box">
                    <input type="text" id="search-input" placeholder="Search text..." />
                    <button id="search-btn" class="tool-btn" title="Search across all chapters">Find</button>
                    <div class="search-navigation hidden" id="search-navigation">
                        <button id="search-prev-btn" class="search-nav-btn" title="Previous occurrence">←</button>
                        <div class="search-info">
                            <span id="search-results-count" class="search-count">0 of 0</span>
                            <span id="search-chapter-label" class="search-chapter"></span>
                        </div>
                        <button id="search-next-btn" class="search-nav-btn" title="Next occurrence">→</button>
                    </div>
                    <button id="clear-search-btn" class="tool-btn" title="Clear search results">Clear</button>
                </div>
                <button id="word-diff-btn" class="tool-btn" title="Compare unique vocabulary between two versions">Word Differential</button>
            </div>
        </div>

        <nav id="chapter-nav" class="chapter-nav">
            <!-- Chapter buttons will be populated by JavaScript -->
        </nav>
    </header>

    <main>
        <div id="comparison-display">
            <!-- Comparison will be rendered here -->
        </div>
    </main>

    <footer>
        <p>
            <em><a href="https://subcutanean.textories.com/">Subcutanean</em></a> by Aaron Reed |
            <a href="https://github.com/samplereality/subcutanean-variorum" target="_blank">Subcutanean Variorum</a> by Mark Sample
        </p>
    </footer>

    <!-- Word Differential Modal -->
    <div id="word-diff-modal" class="modal hidden">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Word Differential Analysis</h2>
                <p id="word-diff-description" class="modal-description"></p>
                <button id="close-modal-btn" class="close-btn">&times;</button>
            </div>
            <div class="modal-controls">
                <label>Sort by:</label>
                <div class="sort-buttons">
                    <button id="sort-alpha-btn" class="sort-btn active" title="Sort words alphabetically">Alphabetical</button>
                    <button id="sort-freq-btn" class="sort-btn" title="Sort words by frequency (most common first)">Frequency</button>
                </div>
            </div>
            <div class="modal-body">
                <div class="diff-results">
                    <div class="unique-words-panel">
                        <h3>Unique to Seed <span id="seed-a-label"></span></h3>
                        <p class="word-count">(<span id="unique-a-count"></span> unique words)</p>
                        <div id="unique-words-a" class="word-list"></div>
                    </div>
                    <div class="unique-words-panel">
                        <h3>Unique to Seed <span id="seed-b-label"></span></h3>
                        <p class="word-count">(<span id="unique-b-count"></span> unique words)</p>
                        <div id="unique-words-b" class="word-list"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Word Chapter Popup -->
    <div id="word-popup" class="word-popup">
        <button id="word-popup-close" class="word-popup-close">&times;</button>
        <div class="word-popup-header">
            Chapters containing "<span id="popup-word"></span>":
        </div>
        <ul id="word-popup-chapters" class="word-popup-chapters">
            <!-- Chapters will be populated by JavaScript -->
        </ul>
    </div>

    <!-- Floating Search Navigation -->
    <div id="floating-search-nav" class="floating-search-nav hidden">
        <button id="floating-prev-btn" class="floating-nav-btn" title="Previous (Shift+F3)">↑</button>
        <div class="floating-info">
            <span id="floating-count" class="floating-count">0/0</span>
            <span id="floating-chapter-label" class="floating-chapter"></span>
        </div>
        <button id="floating-next-btn" class="floating-nav-btn" title="Next (F3)">↓</button>
    </div>

    <!-- Manage Uploads Modal -->
    <div id="manage-uploads-modal" class="modal hidden">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Manage Uploaded Versions</h2>
                <button id="close-manage-modal-btn" class="close-btn">&times;</button>
            </div>
            <div class="modal-body">
                <div id="uploads-list" class="uploads-list">
                    <!-- Upload items will be populated by JavaScript -->
                </div>
                <div id="no-uploads-message" class="no-uploads-message hidden">
                    No custom versions uploaded yet.
                </div>
            </div>
        </div>
    </div>

    <!-- About Modal -->
    <div id="about-modal" class="modal hidden">
        <div class="modal-content about-modal-content">
            <div class="modal-header">
                <h2>Subcutanean Variorum</h2>
                <button id="close-about-modal-btn" class="close-btn">&times;</button>
            </div>
            <div class="modal-body about-modal-body">
                <h3>Overview</h3>
                <p>Aaron Reed’s <em>Subcutanean</em> (2020) is a novel where every copy is different. Using a combinatorial narrative system, Reed generated thousands of unique versions by varying word choices, sentence structures, and entire passages throughout the text. In 2025 Reed released the source text and code of <em>Subcutanean</em> under a CC-BY 4.0 license, meaning anyone can copy, share, modify, or remix the novel as long as credit for the original is given to Reed.</p> 
                    
                <p>This variorum allows readers to compare any two editions side-by-side to discover how the story shifts between versions.</p>

                <h4>Features</h4>
                <ul>
                    <li>25 pre-loaded unique versions (seeds 45443-45467)</li> 
                    <li>Upload additional versions (EPUB or TXT files)</li>
                    <li>Four view modes: Unified, Side-by-side, Track Changes, and Collation</li>
                    <li>Cross-chapter search with keyboard shortcuts (F3, Shift+F3)</li>
                    <li>Word differential analysis showing unique vocabulary between versions</li>
                </ul>

                <h4>How to Use</h4>
                <ol>
                    <li>Select two versions using the dropdown menus</li>
                    <li>Choose a view mode (Unified, Side-by-side, Track Changes, or Collation)</li>
                    <li>Navigate chapters using the chapter menu</li>
                    <li>Search for text or analyze word differences</li>
                    <li>Upload additional EPUB or TXT copies of <em>Subcutanean</em> to compare; Aaron Reed has made <a href="https://subcutanean.textories.com/seeds/">1,000 variants readily available</a> for download</li>
                </ol>

                <h4>Credits</h4>
                <p><em>Subcutanean:</em> <a href="https://aaronareed.net/subcutanean/" target="_blank">Aaron Reed</a><br>
                Variorum: <a href="https:wwww.samplereality.com" target="_blank"> Mark Sample</a><br>
                Project Code: <a href="https://github.com/samplereality/subcutanean-variorum" target="_blank">GitHub Repository</a></p>

                <p class="about-note">This tool is provided by Mark Sample for scholarly and educational purposes. The text of <em>Subcutanean</em> (every single version) is by Aaron Reed.</p>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/diff@5.1.0/dist/diff.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
    <script src="compare.js"></script>
</body>
</html>
